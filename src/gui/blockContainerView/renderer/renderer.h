#ifndef renderer_h
#define renderer_h

#include <vector>

#include "middleEnd/blockContainerManager.h"
#include "../viewManager/viewManager.h"
#include "color.h"


// This is the renderer interface. It defines all the methods that non-windowing
// or renderer-specific code should be able to call. Each implementation is
// responsible for defining a render function and calling it in a loop.

// Under Construction Notes -----
// placeholder system for submitting sprites using BlockType, not sure how they
// will be handled
//
// more effects will be added. maybe for submitting circles and stuff
// it might be cool if tints could fade out too
//
// the final version will not take a viewmanager pointer. That argument will
// be replaced with a view matrix generated by the viewmanager

typedef unsigned int LineID;
typedef unsigned int TintID;
typedef unsigned int BlockPreviewID;
typedef unsigned int ConnectionPreviewID;

class Renderer {
public:
    // main flow
    virtual void setBlockContainer(BlockContainerWrapper* blockContainer) = 0;
    // virtual void setSimulator(Simulator* simulator) = 0;

    virtual void updateView(ViewManager* viewManager) = 0;
    // virtual void updateBlockContainer(Difference diff) = 0;

    // effect layer
    virtual LineID addLine(const std::vector<FPosition>& positions, float width) = 0;
    virtual void updateLinePosition(LineID id, int index, FPosition position) = 0;
    virtual void updateLinePositions(LineID id, std::vector<FPosition>& positions) = 0;
    virtual void updateLineWidth(LineID id, float width) = 0;
    virtual void removeLine(LineID id) = 0;

    virtual TintID addTint(Position position, Color color) = 0;
    virtual TintID addTint(FPosition start, float width, float height, Color color) = 0;
    virtual void updateTintColor(TintID id, Color color) = 0;
    virtual void updateTintRect(TintID id, FPosition start, float width, float height) = 0;
    virtual void removeTint(TintID id) = 0;

    virtual BlockPreviewID addBlockPreview(Position position, Rotation rotation, Color modulate, float alpha) = 0;
    virtual void updateBlockPreviewColor(BlockPreviewID id, Color modulate, float alpha) = 0;
    virtual void removeBlockPreview(BlockPreviewID id) = 0;

    virtual ConnectionPreviewID addConnectionPreview(std::pair<FPosition, FPosition> positions, Color modulate, float alpha) = 0;
    virtual void updateConnectionPreviewPositions(ConnectionPreviewID id, std::pair<FPosition, FPosition> positions) = 0;
    virtual void updateConnectionPreviewColor(ConnectionPreviewID id, Color modulate, float alpha) = 0;
    virtual void removeConnectionPreview(ConnectionPreviewID id) = 0;
    
    virtual void addConfetti(FPosition start) = 0;
};

#endif // renderer_h
